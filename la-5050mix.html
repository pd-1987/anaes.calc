<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">
<link
  href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
  rel="stylesheet"
/>
  <title>LA 50:50 max combined dose</title>

  <style>
    :root {
      --clr-light-grey: #f0f0f0;
      --clr-med-grey:  #ccc;
      --radius:        5px;
    }

    /* Base */
    body {
      font-family: 'Roboto', sans-serif;
      max-width: 600px;
      margin: 0 auto;
      padding: 10px;
    }
    header.banner {
      background: linear-gradient(to right, #2e8b57, #1b5e20);
      color: white;
      text-align: center;
      padding: 10px;
      border-radius: var(--radius);
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      margin-bottom: 20px;
    }

    /* Inputs */
    .input-group {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .input-group label {
      font-weight: 700;
      margin-right: 10px;
    }
    .input-group input {
      width: 60px;
      padding: 5px;
      font-size: 16px;
    }
    .input-note {
      font-size: 0.9em;
      margin-bottom: 20px;
      color: #555;
    }

    /* LA sections – single column */
    /* LA sections – single column */
.la-sections {
  display: block;
  margin-bottom: 20px;
}

.la-column {
  background-color: #fafafa;  /* or white if you prefer */
  border: 1px solid #ddd;
  border-radius: 6px;
  padding: 10px;
  margin-bottom: 1rem;
   box-sizing: border-box;

  /* LEFT-ALIGN EVERYTHING inside */
  text-align: left;
}
    .la-column h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 18px;
      font-weight: 400;
      margin-bottom: 8px;
      text-align: center;
    }
    .la-label {
      text-align: center;
      font-size: 16px;
      margin: 8px 0;
      color: #333;
    }
    .result {
      text-align: center;
      font-size: 16px;
      margin-top: 8px;
    }

    /* Dose-option buttons under LA2 */
    /* Under LA2, left-align the mg/kg buttons */
.dose-options {
  display: flex;
  justify-content: flex-start;  /* instead of center */
  margin: 8px 0 12px;            /* same vertical spacing */
  width: auto;                   /* shrink-wrap */
}
    .dose-options .concentration-btn {
      background-color: #e7f3fe;
      border: 1px solid #bcdffc;
      border-radius: 15px;
      color: #0078d7;
      cursor: pointer;
      margin: 0 6px;
      padding: 4px 8px;
      font-size: 14px;
    }
    .dose-options .concentration-btn.active {
      background-color: #0078d7;
      color: white;
    }

    /* Combined box */
    .combined-box {
     background-color: #fafafa;  /* or white if you prefer */
  border: 1px solid #ddd;
  border-radius: 6px;
      padding: 10px;
      margin-bottom: 20px;
       box-sizing: border-box;
      text-align: center;
    }
    .combined-box h2 {
      text-align: center;
      margin-bottom: 10px;
      font-family: 'Poppins', sans-serif;
      font-size: 18px;
      font-weight: 400;
    }
    /* Override combined-results to be block, not flex */
.combined-results {
  display: block;       /* stack them vertically */
  margin-bottom: 10px;
  font-size: 16px;
  text-align: left;     /* left-align content */
  font-weight: 700;
}

/* Give each inner result its own line and spacing */
.combined-results > div {
  margin-bottom: 8px;
}

/* Also left-align that “Max 50:50 volume” header */
.combined-box .result {
  text-align: left;
  font-weight: 600;     /* optional: make it stand out */
}
    /* Make sure inline percents flow on the same line */
.combined-percent {
  display: inline;     /* instead of block */
  margin: 0;           /* cancel any top/bottom margins */
  font-size: 16px;
  color: #555;
}
    .instruction.header {
      font-weight: 700;
        text-align: left;
    }
/* Increase the gap under the "Max 50:50 volume" heading */
.combined-box .instruction.header {
  margin-bottom: 10px; /* or whatever spacing you like */
}
    .maxresult {
      text-align: center;
    }
    .given-volume-box {
 background-color: #fafafa;  /* or white if you prefer */
  border: 1px solid #ddd;
  border-radius: 6px;
      padding: 10px;
  margin-bottom: 20px;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.given-volume-box label {
  font-weight: 700;
}

.given-volume-box input {
  width: 60px;
  padding: 5px;
  font-size: 16px;
  box-sizing: border-box;
}

.given-volume-box .given-percent {
  margin-left: auto;
  font-weight: 700;
}
  </style>
</head>
<body>

  <header class="banner">Local anaesthetic 50:50 maximum combined dose</header>

  <div class="input-group">
    <label for="weight">Weight (kg):</label>
    <input type="number" id="weight" min="0" placeholder="0" />
  </div>
  <p class="input-note">Use ideal body weight if BMI ≥ 30 kg/m².</p>

  <div class="la-sections">
    <!-- LA 1 -->
    <div class="la-column" id="la1">
      <div class="instruction header">LA 1: Short-acting</div>
     <div class="la-buttons">
  <button type="button" disabled>
    Lidocaine 2% with 1:200,000 adrenaline</button>
</div>

     <div class="maxresult">
        Max single dose: <span id="la1-max">0</span><span class="unit"> mg</span>
      </div>
    </div>

    <!-- LA 2 -->
    <div class="la-column" id="la2">
      <div class="instruction header">LA 2: Long-acting</div>
      <div class="la-buttons">
  <button type="button" disabled>
    Levobupivacaine 0.5%</button>
</div>
      <div class="dose-options">
        <button class="concentration-btn" data-dose="2">Max: <br>2 mg/kg</button>
        <button class="concentration-btn" data-dose="2.5">Max: <br>2.5 mg/kg</button>
        <button class="concentration-btn" data-dose="3">Max: <br>3 mg/kg</button>
      </div>
       <div class="maxresult">
        Max single dose: <span id="la2-max">0</span><span class="unit"> mg</span>
      </div>
    </div>
  </div>

  <!-- Combined 50:50 -->
  <div class="combined-box">
    <div class="instruction header"><u>50:50 Maximum Combined Dose</u>:</div>
   <div class="combined-results">
  <div>
    <span id="comb1-label">LA 1</span>:<br>
    <span id="comb1-dose">0</span><span class="unit"> mg</span> in <span id="comb1-vol">0</span><span class="unit"> mL</span> (<span class="combined-percent unit" id="comb1-perc">0</span><span class="unit">%</span>)
      </div>
      <div>
         <span id="comb2-label">LA 2</span>:<br>
        <span id="comb2-dose">0</span><span class="unit"> mg</span> in <span id="comb2-vol">0</span><span class="unit"> mL</span> (<span class="combined-percent unit" id="comb2-perc">0</span><span class="unit">%</span>)
      </div>
      <div class="total-volume">
  Total volume: <span id="total-vol">0</span><span class="unit"> mL</span>
</div>
</div>
  </div>
  
  <div class="given-volume-box">
  <label for="given-vol">Volume given:</label>
  <input type="number" id="given-vol" min="0" placeholder="0" />
  <span class="unit">mL</span>

  <div class="given-percent">
    <span id="given-perc">0</span><span class="unit">%</span>
  </div>
</div>

  <div class="button-container">
    <button class="reset-btn">Reset</button>
    <button class="home-btn">Home</button>
  </div>
  
  <footer>
    <small>
      <p><strong>Lidocaine with adrenaline:</strong> A maximum dose of 7 mg/kg should not be exceeded in any four-hour period; not to exceed 500 mg per dose.</p>
      <p><strong>Levobupivacaine with adrenaline:</strong> A maximum dose of 2-3 mg/kg should not be exceeded in any four-hour period; not to exceed 200-225 mg per dose. In total ≤400 mg/24h. </p>
           <p><strong>Adrenaline</strong>: No differences in blood flow reduction between adrenaline concentrations of 1:100,000, 1:200,000, and 1:400,000. However, 1:800,000 provides significantly less vasoconstriction.</p>
     <p><a href="references.html">References</a></p>
      <p>&copy; 2025 #OneTeam Anaesthesia. All rights reserved.</p></small>
  </footer>

<script>
  // Grab all elements
  const weightInput = document.getElementById('weight');
  const la1Max       = document.getElementById('la1-max');
  const la2Max       = document.getElementById('la2-max');

  const comb1Dose   = document.getElementById('comb1-dose');
  const comb1Vol    = document.getElementById('comb1-vol');
  const comb1Perc   = document.getElementById('comb1-perc');
  const comb2Dose   = document.getElementById('comb2-dose');
  const comb2Vol    = document.getElementById('comb2-vol');
  const comb2Perc   = document.getElementById('comb2-perc');

  const doseButtons = document.querySelectorAll('.dose-options .concentration-btn');
  const resetBtn    = document.querySelector('.reset-btn');
  const homeBtn     = document.querySelector('.home-btn');
  const la1NameBtn = document.querySelector('#la1 .la-buttons button');
const la2NameBtn = document.querySelector('#la2 .la-buttons button');
const comb1Label  = document.getElementById('comb1-label');
const comb2Label  = document.getElementById('comb2-label');
  const totalVolSpan = document.getElementById('total-vol');
  const givenVolInput  = document.getElementById('given-vol');
const givenPercSpan  = document.getElementById('given-perc');

  let levaPerKg = null;
  
function fmt2(val) {
  return val.toFixed(2).replace(/\.00$/, '');
}

  // Compute safe single doses for LA1 and LA2
  function getSafeDoses() {
    const w = parseFloat(weightInput.value) || 0;
    return {
      s1: Math.min(w * 7, 500),                          // Lidocaine
      s2: levaPerKg ? Math.min(w * levaPerKg, 225) : 0   // Levobupivacaine
    };
  }

  // Update the LA1/LA2 max‐dose displays and recalc combined volumes
  function updateDoses() {
    comb1Label.textContent = la1NameBtn.textContent;
comb2Label.textContent = la2NameBtn.textContent;
    
    const { s1, s2 } = getSafeDoses();

    la1Max.textContent = Math.round(s1);
    la2Max.textContent = Math.round(s2);

    updateCombined(s1, s2);
  }

  // Calculate and display the 50:50 combined volume/dose/percent
  function updateCombined(s1, s2) {
  // concentrations in mg/mL
  const c1 = 2   * 10;  // 2% → 20 mg/mL
  const c2 = 0.5 * 10;  // 0.5% →  5 mg/mL

  let V = 0, d1 = 0, d2 = 0;
  if (s1 > 0 && s2 > 0) {
    const sum = (c1 / s1) + (c2 / s2);
    V  = 1 / sum;
    d1 = c1 * V;
    d2 = c2 * V;
  }

  const p1 = s1 ? (d1 / s1) * 100 : 0;
  const p2 = s2 ? (d2 / s2) * 100 : 0;

  // component volumes
  comb1Vol.textContent    = fmt2(V);
  comb2Vol.textContent    = fmt2(V);

  // total volume = 2 * V
  totalVolSpan.textContent = fmt2(2 * V);

  // doses & percents
  comb1Dose.textContent   = Math.round(d1);
  comb1Perc.textContent   = fmt2(p1);
  comb2Dose.textContent   = Math.round(d2);
  comb2Perc.textContent   = fmt2(p2);

  // update the user-entered % too
  updateGivenPerc();
}

  // When a concentration button is clicked…
  doseButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      doseButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      levaPerKg = parseFloat(btn.dataset.dose);
      updateDoses();
    });
  });
  
function updateGivenPerc() {
  const givenVol = parseFloat(givenVolInput.value) || 0;
  const maxVol   = parseFloat(totalVolSpan.textContent) || 0;
  const percent  = maxVol ? (givenVol / maxVol) * 100 : 0;
  givenPercSpan.textContent = fmt2(percent);
}

  // Recalc on weight change
  weightInput.addEventListener('input', updateDoses);

  // Reset everything to defaults
  resetBtn.addEventListener('click', () => {
  weightInput.value = '';
  levaPerKg = null;
  doseButtons.forEach(b => b.classList.remove('active'));

  // Clear LA max‐dose displays
  la1Max.textContent = '0';
  la2Max.textContent = '0';

  // Clear combined‐mix component volumes, doses & percents
  comb1Vol.textContent  = '0';
  comb1Dose.textContent = '0';
  comb1Perc.textContent = '0';
  comb2Vol.textContent  = '0';
  comb2Dose.textContent = '0';
  comb2Perc.textContent = '0';

  // **NEW** Clear total volume and given‐volume controls
  totalVolSpan.textContent   = '0';
  givenVolInput.value        = '';    // empties the input box
  givenPercSpan.textContent  = '0';   // resets the % display

  // No need to call updateGivenPerc() here since we manually zeroed everything
});

  // Go home
  homeBtn.addEventListener('click', () => {
    window.location.href = '/';
  });
  document.addEventListener('DOMContentLoaded', updateDoses);
  givenVolInput.addEventListener('input', updateGivenPerc);
</script>
</body>
</html>
