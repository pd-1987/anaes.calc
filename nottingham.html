<!DOCTYPE html>
<html lang="en">
<head>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="styles.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nottingham Hip Fracture Score</title>
  <style>
    header.banner {
  background: linear-gradient(
    to right,
    #26C6DA 0%,
    #00ACC1 100%);
    }
    .boxed-section {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 8px;
      margin: 10px;
      box-sizing: border-box;
      background-color: #fafafa;
    }
  </style>
</head>
<body>
  <header class="banner">Nottingham Hip Fracture Score</header>
<h3>Risk of death within 30 days of hip fracture surgery</h3>

 <!-- ===== NHFS INPUTS ===== -->
  <div class="boxed-section">
    <div class="input-group">
      <label for="nhfsAge">Age (years):</label>
      <input type="number" id="nhfsAge" min="0" max="120" value="70" oninput="calculateNHFS()">
    </div>
    <div class="input-group">
      <label>Gender:</label>
      <div class="gender-buttons">
        <button type="button" id="nhfsMale" class="gender-btn active" onclick="setGender('male')">Male</button>
        <button type="button" id="nhfsFemale" class="gender-btn" onclick="setGender('female')">Female</button>
      </div>
    </div>
    <div class="input-group">
      <label for="nhfsAMTS">AMT score (0–10):</label>
      <input type="number" id="nhfsAMTS" min="0" max="10" value="10" oninput="calculateNHFS()">
    </div>
    <div class="input-group">
      <label>Residence:</label>
      <div class="gender-buttons">
        <button type="button" id="nhfsHome" class="gender-btn active" onclick="setResidence('home')">Home</button>
        <button type="button" id="nhfsInst" class="gender-btn" onclick="setResidence('inst')">Institution</button>
      </div>
    </div>
    <div class="input-group">
      <label for="nhfsComorb">Number of major comorbidities:</label>
      <input type="number" id="nhfsComorb" min="0" value="0" oninput="calculateNHFS()">
    </div>
    <!-- NEW: Admission Haemoglobin -->
    <div class="input-group">
      <label for="nhfsHgb">Haemoglobin on admission (g/L):</label>
      <input type="number" id="nhfsHgb" min="0" value="120" oninput="calculateNHFS()">
    </div>
    <div class="input-group">
      <label>Active malignancy:</label>
      <div class="gender-buttons">
        <button type="button" id="nhfsMaligNo" class="gender-btn active" onclick="setMalignancy(false)">No</button>
        <button type="button" id="nhfsMaligYes" class="gender-btn" onclick="setMalignancy(true)">Yes</button>
      </div>
    </div>
  </div>

  <!-- ===== NHFS RESULT ===== -->
  <p class="result">
    <u>NHFS Score:</u> <span id="nhfsScore">0</span>
  </p>
  <p class="result">
    <u>30-day Mortality Risk:</u> <span id="nhfsRisk">—</span>
  </p>
  
   <div class="button-container">
    <button type="button" class="reset-btn" onclick="resetForm()">Reset</button>
    <button type="button" class="home-btn" onclick="goHome()">Home</button>
  </div>
  
  <footer>
    <small>
      <p>&copy; 2025 #OneTeam Anaesthesia. All rights reserved.</p>
    </small>
  </footer>

  <script>
// state
    let gender = 'male', residence = 'home', malignancy = false;

    function setGender(g) {
      gender = g;
      document.getElementById('nhfsMale').classList.toggle('active', g==='male');
      document.getElementById('nhfsFemale').classList.toggle('active', g==='female');
      calculateNHFS();
    }
    function setResidence(r) {
      residence = r;
      document.getElementById('nhfsHome').classList.toggle('active', r==='home');
      document.getElementById('nhfsInst').classList.toggle('active', r==='inst');
      calculateNHFS();
    }
    function setMalignancy(val) {
      malignancy = val;
      document.getElementById('nhfsMaligNo').classList.toggle('active', !val);
      document.getElementById('nhfsMaligYes').classList.toggle('active', val);
      calculateNHFS();
    }

    function calculateNHFS() {
      const age    = +document.getElementById('nhfsAge').value;
      const amts   = +document.getElementById('nhfsAMTS').value;
      const comorb = +document.getElementById('nhfsComorb').value;
      const hgb    = +document.getElementById('nhfsHgb').value;

      let score = 0;
      // Age
      if      (age <= 65) score += 0;
      else if (age <= 85) score += 3;
      else                score += 4;
      // Male
      if (gender === 'male') score += 1;
      // AMTS <7
      if (amts < 7) score += 1;
      // Institutional residence
      if (residence === 'inst') score += 1;
      // >2 comorbidities
      if (comorb > 2) score += 1;
      // Admission Hb <100 g/L  ← NEW
      if (hgb < 100) score += 1;
      // Active malignancy
      if (malignancy) score += 1;

      document.getElementById('nhfsScore').textContent = score;

      // risk categories unchanged
      let riskText;
      if      (score <= 3) riskText = 'Low (≈1%)';
      else if (score <= 6) riskText = 'Medium (≈8%)';
      else                 riskText = 'High (≈35%)';
      document.getElementById('nhfsRisk').textContent = riskText;
    }

    // Update reset to clear Hgb too
    function resetForm() {
      document.getElementById('nhfsAge').value   = 70;
      document.getElementById('nhfsAMTS').value  = 10;
      document.getElementById('nhfsComorb').value= 0;
      document.getElementById('nhfsHgb').value   = 120;    // ← NEW
      setGender('male');
      setResidence('home');
      setMalignancy(false);
      calculateNHFS();
    }
    // initialize
    document.addEventListener('DOMContentLoaded', calculateNHFS);
  </script>
</body>
</html>
